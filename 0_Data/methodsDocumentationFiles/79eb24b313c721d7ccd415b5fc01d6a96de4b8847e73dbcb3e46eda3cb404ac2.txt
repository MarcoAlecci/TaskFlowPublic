 Runs on a worker thread 