 TODO: clean up dependencies and change back to private visibility.